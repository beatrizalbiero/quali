\begin{tikzpicture}

% Input layer
\node[textonly] (h1) {$\boldsymbol{\vdots}$};
\node[unit, above=10pt of h1] (h11) {};
\node[unit, above=10pt of h11] (h12) {};
\node[unit, below=10pt of h1] (h13) {};
\node[unit, below=10pt of h13] (h14) {};
\node[layer, fit=(h1) (h11) (h12) (h13) (h14)] (l1) {};

\node[sublayer, fit=(h1) (h11) (h12) (h13)] (s) {};
\node[sublayer, fit=(h14)] (t) {};

\node[textonly, left=40pt of s] (slbl) {state $\mathbf{s}$};
\node[textonly, left=40pt of t] (tlbl) {timestep $t$};

% Hidden layer 1
\node[textonly, right=40pt of h1] (h2) {$\boldsymbol{\vdots}$};
\node[unit, above=10pt of h2] (h21) {};
\node[unit, above=10pt of h21] (h22) {};
\node[unit, below=10pt of h2] (h23) {};
\node[unit, below=10pt of h23] (h24) {};
\node[layer, fit=(h2) (h21) (h22) (h23) (h24)]  (l2) {};

% \node[textonly, below=10pt of l2] () {$l = 2$};

\node[textonly, right=30pt of h2] (middle) {$\boldsymbol{\cdots}$};

% Hidden layer L-1
\node[textonly, right=30pt of middle] (h3) {$\boldsymbol{\vdots}$};
\node[unit, above=10pt of h3] (h31) {};
\node[unit, above=10pt of h31] (h32) {};
\node[unit, below=10pt of h3] (h33) {};
\node[unit, below=10pt of h33] (h34) {};
\node[layer, fit=(h3) (h31) (h32) (h33) (h34)] (l3) {};

% Hidden layer L
\node[textonly, right=40pt of h3] (h4) {$\boldsymbol{\vdots}$};
\node[unit, above=10pt of h4] (h41) {};
\node[unit, above=10pt of h41] (h42) {};
\node[unit, below=10pt of h4] (h43) {};
\node[unit, below=10pt of h43] (h44) {};
\node[layer, fit=(h4) (h41) (h42) (h43) (h44)]  (l4) {};

% \node[textonly, below=10pt of l4] () {$l = L$};

% Output layer
\node[outputvec, right=50pt of h4] (y) {$\mathbf{a}_t$};

\path[activation] (slbl) -- (s);
\path[activation] (tlbl) -- (t);
\path[activation] (l1) -- node[above] {$\mathbf{h}_1$} (l2);
\path[activation] (l2) -- node[above] {$\mathbf{h}_2$} (middle);
\path[activation] (middle) -- (l3);
\path[activation] (l3) -- node[above] {$\mathbf{h}_{L-1}$} (l4);
\path[activation] (l4) -- node[above, near start] (hL) {$\mathbf{h}_{L}$} (y);

\node[container, fit=(l1) (l2) (l3) (l4) (hL)] () {};

\end{tikzpicture}
